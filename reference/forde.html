<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Uses a pre-trained ARF model to estimate leaf and distribution parameters."><title>Forests for Density Estimation — forde • arf</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Forests for Density Estimation — forde"><meta property="og:description" content="Uses a pre-trained ARF model to estimate leaf and distribution parameters."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">arf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette.html">Adversarial Random Forests</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bips-hb/arf/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Forests for Density Estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/bips-hb/arf/blob/HEAD/R/forde.R" class="external-link"><code>R/forde.R</code></a></small>
      <div class="d-none name"><code>forde.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses a pre-trained ARF model to estimate leaf and distribution parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">forde</span><span class="op">(</span></span>
<span>  <span class="va">arf</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  oob <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"truncnorm"</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>arf</dt>
<dd><p>Pre-trained <code><a href="adversarial_rf.html">adversarial_rf</a></code>. Alternatively, any
object of class <code>ranger</code>.</p></dd>


<dt>x</dt>
<dd><p>Training data for estimating parameters.</p></dd>


<dt>oob</dt>
<dd><p>Only use out-of-bag samples for parameter estimation? If
<code>TRUE</code>, <code>x</code> must be the same dataset used to train <code>arf</code>.</p></dd>


<dt>family</dt>
<dd><p>Distribution to use for density estimation of continuous
features. Current options include truncated normal (the default
<code>family = "truncnorm"</code>) and uniform (<code>family = "unif"</code>). See
Details.</p></dd>


<dt>epsilon</dt>
<dd><p>Slack parameter on empirical bounds when <code>family = "unif"</code>.
This avoids zero-density points when test data fall outside the support
of training data. The gap between lower and upper bounds is expanded by
a factor of <code>epsilon</code>. Only used when a variable is never selected for
splitting.</p></dd>


<dt>parallel</dt>
<dd><p>Compute in parallel? Must register backend beforehand, e.g.
via <code>doParallel</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>list</code> with 4 elements: (1) parameters for continuous data; (2)
parameters for discrete data; (3) leaf indices and coverage; and (4) metadata
on variables. This list is used for estimating likelihoods with
<code><a href="lik.html">lik</a></code> and generating data with <code><a href="forge.html">forge</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>forde</code> extracts leaf parameters from a pretrained forest and learns
distribution parameters for data within each leaf. The former includes
coverage (proportion of data falling into the leaf) and split criteria. The
latter includes proportions for categorical features and mean/variance for
continuous features. These values are stored in a <code>data.table</code>, which
can be used as input to various other functions.</p>
<p>Currently, <code>forde</code> only provides support for a limited number of
distributional families: truncated normal or uniform for continuous data,
and multinomial for discrete data. Future releases will accommodate a larger
set of options.</p>
<p>Though <code>forde</code> was designed to take an adversarial random forest as
input, the function's first argument can in principle be any object of class
<code>ranger</code>. This allows users to test performance with alternative
pipelines (e.g., with supervised forest input). There is also no requirement
that <code>x</code> be the data used to fit <code>arf</code>, unless <code>oob = TRUE</code>.
In fact, using another dataset here may protect against overfitting. This
connects with Wager &amp; Athey's (2018) notion of "honest trees".</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Watson, D., Blesch, K., Kapar, J., &amp; Wright, M. (2022). Adversarial random
forests for density estimation and generative modeling. <em>arXiv</em> preprint,
2205.09435.</p>
<p>Wager, S. &amp; Athey, S. (2018). Estimation and inference of heterogeneous
treatment effects using random forests. <em>J. Am. Stat. Assoc.</em>,
<em>113</em>(523): 1228-1242.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="adversarial_rf.html">adversarial_rf</a></code>, <code><a href="forge.html">forge</a></code>, <code><a href="lik.html">lik</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">arf</span> <span class="op">&lt;-</span> <span class="fu"><a href="adversarial_rf.html">adversarial_rf</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration: 0, Accuracy: 84.69%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration: 1, Accuracy: 42.57%</span>
<span class="r-in"><span><span class="va">psi</span> <span class="op">&lt;-</span> <span class="fu">forde</span><span class="op">(</span><span class="va">arf</span>, <span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cnt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          variable  min  max f_idx       mu        sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: Sepal.Length -Inf  Inf    12 5.155556 0.2172083957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: Sepal.Length -Inf  Inf    21 4.900000 0.1000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: Sepal.Length -Inf  Inf     4 4.511111 0.1452966315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: Sepal.Length -Inf 4.75     2 4.600000 0.0008211816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: Sepal.Length -Inf  Inf    18 5.200000 0.6745368782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 676:  Petal.Width -Inf  Inf   168 1.475000 0.0500000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 677:  Petal.Width -Inf  Inf   162 1.862500 0.0916125381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 678:  Petal.Width -Inf 2.35   155 2.009091 0.2553963052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 679:  Petal.Width -Inf  Inf   158 2.460000 0.0547722558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 680:  Petal.Width -Inf  Inf   154 2.000000 0.2708012802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      variable       val       prob f_idx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:  Species    setosa 1.00000000    12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:  Species    setosa 1.00000000    21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:  Species    setosa 1.00000000     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:  Species    setosa 1.00000000     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:  Species    setosa 0.80000000    18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 198:  Species virginica 1.00000000   154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 199:  Species virginica 0.96969697   155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 200:  Species virginica 0.09090909   164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 201:  Species virginica 0.87500000   162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 202:  Species virginica 0.14285714   165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $forest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      f_idx tree leaf        cvg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:     1    1   12 0.02000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     2    1   17 0.01333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:     3    1   26 0.04000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:     4    1   29 0.06000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:     5    1   38 0.04666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 166:   166   10   68 0.16000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 167:   167   10   74 0.08000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 168:   168   10   79 0.02666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169:   169   10   82 0.08666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 170:   170   10   85 0.01333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $meta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        variable   class    family</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: Sepal.Length numeric truncnorm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:  Sepal.Width numeric truncnorm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: Petal.Length numeric truncnorm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:  Petal.Width numeric truncnorm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:      Species  factor  multinom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Marvin N. Wright, David S. Watson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

